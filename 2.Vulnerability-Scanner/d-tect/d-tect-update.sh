#!/bin/bash

bold=$(tput bold)
normal=$(tput sgr0)

echo "${bold}
 ____      _____ _____ ____ _____ 
|  _ \    |_   _| ____/ ___|_   _|
| | | |_____| | |  _|| |     | |  
| |_| |_____| | | |__| |___  | |  
|____/      |_| |_____\____| |_|  
               
${normal}"

GITREPOROOT=/opt/ITSEC/2.Vulnerability-Scanner/d-tect/shawarkhanethicalhacker/D-TECT
GITREPOGITFILE=$GITREPOROOT/.git
sudo rm -f /usr/local/bin/d-tect

mkdir -p /opt/ITSEC/2.Vulnerability-Scanner/d-tect/shawarkhanethicalhacker
cd /opt/ITSEC/2.Vulnerability-Scanner/d-tect/shawarkhanethicalhacker
git clone https://github.com/shawarkhanethicalhacker/D-TECT.git

DSKTPFLS=/opt/ITSEC-Install-Scripts/0.Initial/usrlcl/.local/share/applications/2.Vulnerability-Scanner
DSKTPFLSDEST=/home/$USER/.local/share/applications/2.Vulnerability-Scanner
DSKTPFL=d-tect.desktop

cd $GITREPOROOT
git clean -f
git fetch origin
git reset --hard origin/master
git pull
git submodule init
git submodule update --recursive

echo '#!/bin/bash
cd /opt/ITSEC/2.Vulnerability-Scanner/d-tect/shawarkhanethicalhacker/D-TECT
python d-tect.py "$@"' >  d-tect.sh

chmod +x d-tect.py
chmod +x d-tect.sh
sudo ln -s /opt/ITSEC/2.Vulnerability-Scanner/d-tect/shawarkhanethicalhacker/D-TECT/d-tect.sh /usr/local/bin/d-tect
rm -f $DSKTPFLSDEST/$DSKTPFL
mkdir -p $DSKTPFLSDEST
cp $DSKTPFLS/$DSKTPFL $DSKTPFLSDEST/$DSKTPFL
