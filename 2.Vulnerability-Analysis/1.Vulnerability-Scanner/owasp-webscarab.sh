#!/bin/bash

mkdir -p /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP
cd /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP
git clone https://github.com/OWASP/OWASP-WebScarab.git

sudo updatedb
sudo ldconfig
GITREPOROOT=/opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab/
#
DSKTPFLS=/opt/ITSEC-Install-Scripts/0.Initial/usrlcl/.local/share/applications/2.Vulnerability-Analysis/1.Vulnerability-Scanner
DSKTPFLSDEST=/home/$USER/.local/share/applications/2.Vulnerability-Analysis/1.Vulnerability-Scanner
DSKTPFL=webscarab.desktop

cd $GITREPOROOT
sudo rm  -f /usr/local/bin/webscarab
sudo rm -f  /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab/webscarab

git clean -f
git fetch origin
git reset --hard origin/master
git pull
git submodule init
git submodule update --recursive
ant -d
cd /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab
echo "#!/bin/bash 
cd /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab

java -jar webscarab.jar" > webscarab.sh

chmod +x webscarab
chmod +x webscarab.sh
sudo ln -s /opt/ITSEC/2.Vulnerability-Analysis/1.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab/webscarab.sh /usr/local/bin/webscarab

mkdir -p $DSKTPFLSDEST
cp $DSKTPFLS/$DSKTPFL $DSKTPFLSDEST/$DSKTPFL


