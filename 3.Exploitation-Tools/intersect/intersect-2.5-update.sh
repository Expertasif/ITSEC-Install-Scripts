#!/bin/bash

bold=$(tput bold)
normal=$(tput sgr0)

echo "${bold}
 ___ _   _ _____ _____ ____  ____  _____ ____ _____ 
|_ _| \ | |_   _| ____|  _ \/ ___|| ____/ ___|_   _|
 | ||  \| | | | |  _| | |_) \___ \|  _|| |     | |  
 | || |\  | | | | |___|  _ < ___) | |__| |___  | |  
|___|_| \_| |_| |_____|_| \_\____/|_____\____| |_|  
                
${normal}"

mkdir -p /opt/ITSEC/3.Exploitation-Tools/intersect-2-5/deadbits
cd /opt/ITSEC/3.Exploitation-Tools/intersect-2-5/deadbits
git clone https://github.com/deadbits/Intersect-2.5.git

GITREPOROOT=/opt/ITSEC/3.Exploitation-Tools/intersect-2-5/deadbits/Intersect-2.5
GITREPOGITFILE=$GITREPOROOT/.git
DSKTPFLS=/opt/ITSEC-Install-Scripts/0.Initial/usrlcl/.local/share/applications/3.Exploitation-Tools
DSKTPFLSDEST=/home/$USER/.local/share/applications/3.Exploitation-Tools
DSKTPFL=intersect.desktop

cd $GITREPOROOT
git clean -f 
git fetch origin
git reset --hard origin/master
git pull
git submodule init
git submodule update --recursive

sudo rm -f /usr/local/bin/intersect
chmod +x Create.py 
echo '#!/bin/bash
cd /opt/ITSEC/3.Exploitation-Tools/intersect-2-5/deadbits/Intersect-2.5
python Create.py "$@"' > intersect.sh
chmod +x intersect.sh
sudo ln -s /opt/ITSEC/3.Exploitation-Tools/intersect-2-5/deadbits/Intersect-2.5/intersect.sh /usr/local/bin/intersect
rm -f $DSKTPFLSDEST/$DSKTPFL
mkdir -p $DSKTPFLSDEST
cp $DSKTPFLS/$DSKTPFL $DSKTPFLSDEST/$DSKTPFL